<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libparanut: Thread Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libparanut
   </div>
   <div id="projectbrief">A Hardware Abstraction Layer for ParaNut Architectures.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Thread Module<div class="ingroups"><a class="el" href="group__mo.html">libparanut Modules</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for using the threaded mode.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Thread Module:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__th.png" border="0" alt="" usemap="#group____th"/>
<map name="group____th" id="group____th">
<area shape="rect" id="node1" href="group__mo.html" title="Modules of libparanut. " alt="" coords="5,5,136,32"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="memitem:ga157c10cafb8d6c98626fd037a5ed56d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__th.html#ga157c10cafb8d6c98626fd037a5ed56d3">pn_thread_entry</a> (void)</td></tr>
<tr class="memdesc:ga157c10cafb8d6c98626fd037a5ed56d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that has to be called for CoPUs at the end of the startup code.  <a href="#ga157c10cafb8d6c98626fd037a5ed56d3">More...</a><br /></td></tr>
<tr class="separator:ga157c10cafb8d6c98626fd037a5ed56d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga340a319b289e3d5270c205c30b85fb8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ty.html#ga70430b39399120ad6085ea62eac2aea6">PN_CID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__th.html#ga340a319b289e3d5270c205c30b85fb8b">pn_begin_threaded</a> (<a class="el" href="group__ty.html#gab30f39cc6d99b691db3b170a1f714fbe">PN_NUMC</a> numcores)</td></tr>
<tr class="memdesc:ga340a319b289e3d5270c205c30b85fb8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Puts numcores CPUs in threaded mode.  <a href="#ga340a319b289e3d5270c205c30b85fb8b">More...</a><br /></td></tr>
<tr class="separator:ga340a319b289e3d5270c205c30b85fb8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad87d5ef099295dc3aa03c18bc7907f03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ty.html#ga70430b39399120ad6085ea62eac2aea6">PN_CID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__th.html#gad87d5ef099295dc3aa03c18bc7907f03">pn_begin_threaded_m</a> (<a class="el" href="group__ty.html#gac09b7cad5e9aa981f3f459ec8dc56b78">PN_CMSK</a> coremask)</td></tr>
<tr class="memdesc:gad87d5ef099295dc3aa03c18bc7907f03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Puts the CPUs specified in the coremask in threaded mode.  <a href="#gad87d5ef099295dc3aa03c18bc7907f03">More...</a><br /></td></tr>
<tr class="separator:gad87d5ef099295dc3aa03c18bc7907f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1045bf5a7e022407bfc242f15fd13ac9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ty.html#ga70430b39399120ad6085ea62eac2aea6">PN_CID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__th.html#ga1045bf5a7e022407bfc242f15fd13ac9">pn_begin_threaded_gm</a> (<a class="el" href="group__ty.html#gac09b7cad5e9aa981f3f459ec8dc56b78">PN_CMSK</a> *coremask_array, <a class="el" href="group__ty.html#ga9a256902917e7a24ca979059b76a1fc8">PN_NUMG</a> array_size)</td></tr>
<tr class="memdesc:ga1045bf5a7e022407bfc242f15fd13ac9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Puts the CPUs specified in the coremask_array in threaded mode.  <a href="#ga1045bf5a7e022407bfc242f15fd13ac9">More...</a><br /></td></tr>
<tr class="separator:ga1045bf5a7e022407bfc242f15fd13ac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad6144f1e403bbee69ead66cb6612e806"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__th.html#gad6144f1e403bbee69ead66cb6612e806">pn_end_threaded</a> (void)</td></tr>
<tr class="memdesc:gad6144f1e403bbee69ead66cb6612e806"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ends threaded execution.  <a href="#gad6144f1e403bbee69ead66cb6612e806">More...</a><br /></td></tr>
<tr class="separator:gad6144f1e403bbee69ead66cb6612e806"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions for using the threaded mode. </p>
<p>Also see <a class="el" href="group__ms.html">Modes</a>. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga340a319b289e3d5270c205c30b85fb8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga340a319b289e3d5270c205c30b85fb8b">&#9670;&nbsp;</a></span>pn_begin_threaded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ty.html#ga70430b39399120ad6085ea62eac2aea6">PN_CID</a> pn_begin_threaded </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ty.html#gab30f39cc6d99b691db3b170a1f714fbe">PN_NUMC</a>&#160;</td>
          <td class="paramname"><em>numcores</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Puts numcores CPUs in threaded mode. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd>Not yet implemented for more cores than what is available in one group. Will return <a class="el" href="group__er.html#ga7fa757e1c8320021b0f75d0065b658ab">PN_ERR_NOIMP</a> when called with more cores.</dd></dl>
<p>Sets numcores-1 CoPUs to Mode 2 (unlinked Mode) so they start executing the following code in parallel. This function will return an error (<a class="el" href="group__er.html#ga17ec4640eb60bc941c305fbec7944b87">PN_ERR_MATCH</a>) if the CoPUs are not all halted.</p>
<p>See documentation of <a class="el" href="group__ms.html">Modes</a> for more information.</p>
<p>Cannot be executed on CoPU. Cannot be mixed with linked mode or other begin threaded functions, until <a class="el" href="group__th.html#gad6144f1e403bbee69ead66cb6612e806">pn_end_threaded()</a> is called.</p>
<dl class="section attention"><dt>Attention</dt><dd>All data that you want to preserve after <a class="el" href="group__th.html#gad6144f1e403bbee69ead66cb6612e806">pn_end_threaded()</a> was called can not be stored on stack. You can make it static or global.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>There is no guarantee that the execution of code actually happens at the same time on CePUs and CoPUs.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numcores</td><td>is the number of cores that shall run threaded. A value of 0 or 1 will return an error (<a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>) to aid debugging. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The ID of the core, or <a class="el" href="group__er.html#ga17ec4640eb60bc941c305fbec7944b87">PN_ERR_MATCH</a>, <a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>, or <a class="el" href="group__er.html#ga33ae98c7f4278afbc055eac7a63b091d">PN_ERR_COPU</a>. </dd></dl>

</div>
</div>
<a id="ga1045bf5a7e022407bfc242f15fd13ac9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1045bf5a7e022407bfc242f15fd13ac9">&#9670;&nbsp;</a></span>pn_begin_threaded_gm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ty.html#ga70430b39399120ad6085ea62eac2aea6">PN_CID</a> pn_begin_threaded_gm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ty.html#gac09b7cad5e9aa981f3f459ec8dc56b78">PN_CMSK</a> *&#160;</td>
          <td class="paramname"><em>coremask_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__ty.html#ga9a256902917e7a24ca979059b76a1fc8">PN_NUMG</a>&#160;</td>
          <td class="paramname"><em>array_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Puts the CPUs specified in the coremask_array in threaded mode. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>Currently only a stub. Will therefore always return <a class="el" href="group__er.html#ga7fa757e1c8320021b0f75d0065b658ab">PN_ERR_NOIMP</a>.</dd></dl>
<p>Sets the CoPUs represented by bitmask and their position in the array (= their group number) to Mode 2 (unlinked Mode) so they start executing the following code in parallel. This function will return an error (<a class="el" href="group__er.html#ga17ec4640eb60bc941c305fbec7944b87">PN_ERR_MATCH</a>) if the CoPUs are not all halted.</p>
<p>See documentation of <a class="el" href="group__ms.html">Modes</a> for more information.</p>
<p>Cannot be executed on CoPU. Cannot be mixed with linked mode or other begin threaded functions, until <a class="el" href="group__th.html#gad6144f1e403bbee69ead66cb6612e806">pn_end_threaded()</a> is called.</p>
<dl class="section attention"><dt>Attention</dt><dd>All data that you want to preserve after <a class="el" href="group__th.html#gad6144f1e403bbee69ead66cb6612e806">pn_end_threaded()</a> was called can not be stored on stack. You can make it static or global.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>There is no guarantee that the execution of code actually happens at the same time on CePUs and CoPUs.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coremask_array</td><td>is a pointer to the start of a coremask array. The position of the mask in the array represents the group number of the cores. When all bits are set to 0, this function will return an error (<a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>) to aid debugging. Also, not setting the first bit to 1 will return an error (<a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>) since it represents the CePU (which needs to run threaded, too). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">array_size</td><td>is the number of entries in the coremask_array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The ID of the core, or <a class="el" href="group__er.html#ga17ec4640eb60bc941c305fbec7944b87">PN_ERR_MATCH</a>, <a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>, or <a class="el" href="group__er.html#ga33ae98c7f4278afbc055eac7a63b091d">PN_ERR_COPU</a>. </dd></dl>

</div>
</div>
<a id="gad87d5ef099295dc3aa03c18bc7907f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad87d5ef099295dc3aa03c18bc7907f03">&#9670;&nbsp;</a></span>pn_begin_threaded_m()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ty.html#ga70430b39399120ad6085ea62eac2aea6">PN_CID</a> pn_begin_threaded_m </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ty.html#gac09b7cad5e9aa981f3f459ec8dc56b78">PN_CMSK</a>&#160;</td>
          <td class="paramname"><em>coremask</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Puts the CPUs specified in the coremask in threaded mode. </p>
<p>Sets the CoPUs represented by the bitmask to Mode 2 (unlinked Mode) so they start executing the following code in parallel. This function will return an error (<a class="el" href="group__er.html#ga17ec4640eb60bc941c305fbec7944b87">PN_ERR_MATCH</a>) if the CoPUs are not all halted.</p>
<p>See documentation of <a class="el" href="group__ms.html">Modes</a> for more information.</p>
<p>Cannot be executed on CoPU. Cannot be mixed with linked mode or other begin threaded functions, until <a class="el" href="group__th.html#gad6144f1e403bbee69ead66cb6612e806">pn_end_threaded()</a> is called.</p>
<dl class="section attention"><dt>Attention</dt><dd>All data that you want to preserve after <a class="el" href="group__th.html#gad6144f1e403bbee69ead66cb6612e806">pn_end_threaded()</a> was called can not be stored on stack. You can make it static or global.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>There is no guarantee that the execution of code actually happens at the same time on CePUs and CoPUs.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">coremask</td><td>is the bitmask representing the CoPUs you want to run threaded. When all bits are set to 0, this function will return an error (<a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>) to aid debugging. Also, not setting the first bit to 1 will return an error (<a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>) since it represents the CePU (which needs to run threaded, too). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The ID of the core, or <a class="el" href="group__er.html#ga17ec4640eb60bc941c305fbec7944b87">PN_ERR_MATCH</a>, <a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>, or <a class="el" href="group__er.html#ga33ae98c7f4278afbc055eac7a63b091d">PN_ERR_COPU</a>. </dd></dl>

</div>
</div>
<a id="gad6144f1e403bbee69ead66cb6612e806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad6144f1e403bbee69ead66cb6612e806">&#9670;&nbsp;</a></span>pn_end_threaded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pn_end_threaded </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ends threaded execution. </p>
<p>On CoPU, halts the core. On CePU, waits until all other cores are halted. This ends the threaded mode.</p>
<p>See documentation of <a class="el" href="group__ms.html">Modes</a> for more information.</p>
<dl class="section return"><dt>Returns</dt><dd>Either <a class="el" href="group__er.html#ga5d8b16ffb32e1abf285f5a256aeede23">PN_SUCCESS</a> or <a class="el" href="group__er.html#ga17ec4640eb60bc941c305fbec7944b87">PN_ERR_MATCH</a>. </dd></dl>

</div>
</div>
<a id="ga157c10cafb8d6c98626fd037a5ed56d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga157c10cafb8d6c98626fd037a5ed56d3">&#9670;&nbsp;</a></span>pn_thread_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pn_thread_entry </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that has to be called for CoPUs at the end of the startup code. </p>
<p>Marks the entry point of CoPUs into the <a class="el" href="group__th.html">Thread Module</a>. Necessary for threaded Mode.</p>
<p>The CoPUs are set up to work correctly in threaded Mode.</p>
<p>Execution is only effective on CoPU. Can be executed on CePU, will do nothing then.</p>
<p>Should not be called in a normal application at all. Left in here for startup code writers convenience.</p>
<dl class="section attention"><dt>Attention</dt><dd>What comes after this part in the startup code is irrelevant, since the CoPUs that landed there are either put into threaded mode or halted. The function can therefore not return any errors. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
