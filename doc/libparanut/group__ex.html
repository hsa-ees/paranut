<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libparanut: Exception Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libparanut
   </div>
   <div id="projectbrief">A Hardware Abstraction Layer for ParaNut Architectures.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Exception Module<div class="ingroups"><a class="el" href="group__mo.html">libparanut Modules</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for controlling the handling of interrupts/exceptions.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Exception Module:</div>
<div class="dyncontent">
<div class="center"><img src="group__ex.png" border="0" usemap="#agroup____ex" alt=""/></div>
<map name="agroup____ex" id="agroup____ex">
<area shape="rect" title="Functions for controlling the handling of interrupts/exceptions." alt="" coords="200,5,339,31"/>
<area shape="rect" href="group__mo.html" title="Modules of libparanut." alt="" coords="5,5,152,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="memitem:gadc3cc5948f345036b6f9f147cc7152b9"><td class="memItemLeft" align="right" valign="top"><a id="gadc3cc5948f345036b6f9f147cc7152b9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ex.html#gadc3cc5948f345036b6f9f147cc7152b9">pn_exception_init</a> (void)</td></tr>
<tr class="memdesc:gadc3cc5948f345036b6f9f147cc7152b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes libparanut internal exception handling. Interrupts (not exceptions in general!) are disabled after. Should be called before using <a class="el" href="group__ex.html#ga2355303d91aaaf3576c0bcb5a0b22fe0">pn_exception_set_handler()</a>. <br /></td></tr>
<tr class="separator:gadc3cc5948f345036b6f9f147cc7152b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2355303d91aaaf3576c0bcb5a0b22fe0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ex.html#ga2355303d91aaaf3576c0bcb5a0b22fe0">pn_exception_set_handler</a> (void(*handler)(unsigned int cause, unsigned int program_counter, unsigned int mtval), unsigned int exception_code)</td></tr>
<tr class="memdesc:ga2355303d91aaaf3576c0bcb5a0b22fe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set your own exception handler.  <a href="group__ex.html#ga2355303d91aaaf3576c0bcb5a0b22fe0">More...</a><br /></td></tr>
<tr class="separator:ga2355303d91aaaf3576c0bcb5a0b22fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7949ec28da99ddbfe629d6069ed8ec7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ex.html#gaf7949ec28da99ddbfe629d6069ed8ec7">pn_ecall</a> (void)</td></tr>
<tr class="memdesc:gaf7949ec28da99ddbfe629d6069ed8ec7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raises an environment call exception.  <a href="group__ex.html#gaf7949ec28da99ddbfe629d6069ed8ec7">More...</a><br /></td></tr>
<tr class="separator:gaf7949ec28da99ddbfe629d6069ed8ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga77f7418a7e8917d550d2bd899486cd20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ex.html#ga77f7418a7e8917d550d2bd899486cd20">pn_interrupt_enable</a> (void)</td></tr>
<tr class="memdesc:ga77f7418a7e8917d550d2bd899486cd20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables interrupts only.  <a href="group__ex.html#ga77f7418a7e8917d550d2bd899486cd20">More...</a><br /></td></tr>
<tr class="separator:ga77f7418a7e8917d550d2bd899486cd20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6bc2d22cf1580fee2349bdde5e34ebf0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ex.html#ga6bc2d22cf1580fee2349bdde5e34ebf0">pn_interrupt_disable</a> (void)</td></tr>
<tr class="memdesc:ga6bc2d22cf1580fee2349bdde5e34ebf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables interrupts only.  <a href="group__ex.html#ga6bc2d22cf1580fee2349bdde5e34ebf0">More...</a><br /></td></tr>
<tr class="separator:ga6bc2d22cf1580fee2349bdde5e34ebf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f68555275f5163f8b406834de3ec80a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ex.html#ga7f68555275f5163f8b406834de3ec80a">pn_progress_mepc</a> (void)</td></tr>
<tr class="memdesc:ga7f68555275f5163f8b406834de3ec80a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets program counter of the register which keeps the exception return adress to next instruction.  <a href="group__ex.html#ga7f68555275f5163f8b406834de3ec80a">More...</a><br /></td></tr>
<tr class="separator:ga7f68555275f5163f8b406834de3ec80a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions for controlling the handling of interrupts/exceptions. </p>
<p>Why are we calling this exceptions, even though most people would call this an interrupt? Historic reasons. The libparanut was first written for the RISCV implementation of the ParaNut, and the RISCV specification refers to both interrupts and exceptions as exceptions. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaf7949ec28da99ddbfe629d6069ed8ec7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf7949ec28da99ddbfe629d6069ed8ec7">&#9670;&nbsp;</a></span>pn_ecall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pn_ecall </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Raises an environment call exception. </p>
<p>Can be called without using <a class="el" href="group__ex.html#gadc3cc5948f345036b6f9f147cc7152b9">pn_exception_init()</a> first. </p>

</div>
</div>
<a id="ga2355303d91aaaf3576c0bcb5a0b22fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2355303d91aaaf3576c0bcb5a0b22fe0">&#9670;&nbsp;</a></span>pn_exception_set_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pn_exception_set_handler </td>
          <td>(</td>
          <td class="paramtype">void(*)(unsigned int cause, unsigned int program_counter, unsigned int mtval)&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>exception_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set your own exception handler. </p>
<p>Can be called without using <a class="el" href="group__ex.html#gadc3cc5948f345036b6f9f147cc7152b9">pn_exception_init()</a> first, will not work though.</p>
<p>Already does the work of saving away registers, setting program counter etc. for you. You can just hang in what you want to do.</p>
<dl class="section attention"><dt>Attention</dt><dd>For exceptions, the register that contains the adress where execution resumes is set to the faulty instruction that threw the exception. For interrupts, it already points to the instruction where execution should resume. Consider this in your handler. If you need to, use <a class="el" href="group__ex.html#ga7f68555275f5163f8b406834de3ec80a">pn_progress_mepc</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">handler</td><td>is a function pointer to your exception handler. Will return an error (<a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>) if NULL is given. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exception_code</td><td>is the number that your exception has. You can look up the exception codes in the ParaNut Manual. For interrupts, the value of the most significant bit of the exception code has to be 1. For synchronous exceptions, it has to be 0. This function will return an error (<a class="el" href="group__er.html#gabf4974bda55c6a0be8a431dfa4b2d099">PN_ERR_EXC</a>) if a non implemented value for cause is given. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Either <a class="el" href="group__er.html#ga5d8b16ffb32e1abf285f5a256aeede23">PN_SUCCESS</a>, <a class="el" href="group__er.html#gabf4974bda55c6a0be8a431dfa4b2d099">PN_ERR_EXC</a>, or <a class="el" href="group__er.html#ga79d927862dc5bcded0f822c35cd3da7c">PN_ERR_PARAM</a>. </dd></dl>

</div>
</div>
<a id="ga6bc2d22cf1580fee2349bdde5e34ebf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6bc2d22cf1580fee2349bdde5e34ebf0">&#9670;&nbsp;</a></span>pn_interrupt_disable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pn_interrupt_disable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disables interrupts only. </p>
<p>Can be called without using <a class="el" href="group__ex.html#gadc3cc5948f345036b6f9f147cc7152b9">pn_exception_init()</a> first. </p>

</div>
</div>
<a id="ga77f7418a7e8917d550d2bd899486cd20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga77f7418a7e8917d550d2bd899486cd20">&#9670;&nbsp;</a></span>pn_interrupt_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pn_interrupt_enable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables interrupts only. </p>
<p>Can be called without using <a class="el" href="group__ex.html#gadc3cc5948f345036b6f9f147cc7152b9">pn_exception_init()</a> first. </p>

</div>
</div>
<a id="ga7f68555275f5163f8b406834de3ec80a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f68555275f5163f8b406834de3ec80a">&#9670;&nbsp;</a></span>pn_progress_mepc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pn_progress_mepc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets program counter of the register which keeps the exception return adress to next instruction. </p>
<p>Can be called without using <a class="el" href="group__ex.html#gadc3cc5948f345036b6f9f147cc7152b9">pn_exception_init()</a> first. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
